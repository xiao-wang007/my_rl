Using mps device
/Users/xiao/miniforge3/envs/robotics/lib/python3.12/site-packages/stable_baselines3/common/on_policy_algorithm.py:150: UserWarning: You are trying to run PPO on the GPU, but it is primarily intended to run on the CPU when not using a CNN policy (you are using ActorCriticPolicy which should be a MlpPolicy). See https://github.com/DLR-RM/stable-baselines3/issues/1245 for more info. You can pass `device='cpu'` or `export CUDA_VISIBLE_DEVICES=` to force using the CPU.Note: The model will train, but the GPU utilization will be poor and the training might take longer than on CPU.
  warnings.warn(
Logging to runs/j6nsf11i/PPO_1
[2K---------------------------------â•¸[0m[38;5;237mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m12,114/3,000,000 [0m [ [33m0:00:11[0m < [36m0:46:12[0m , [31m1,078 it/s[0m ]
| rollout/           |          |
|    ep_len_mean     | 3.7      |
|    ep_rew_mean     | 7.06     |
| time/              |          |
|    fps             | 1065     |
|    iterations      | 1        |
|    time_elapsed    | 11       |
|    total_timesteps | 12288    |
---------------------------------
[2KTraceback (most recent call last):[0m[38;5;237mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m12,228/3,000,000 [0m [ [33m0:00:22[0m < [36m0:46:14[0m , [31m1,077 it/s[0m ]
[2K  File "/Users/xiao/0_codes/my_rl/drake-gym/drake_gym/examples/train_franka_reach_PPO.py", line 265, in <module>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m12,228/3,000,000 [0m [ [33m0:00:22[0m < [36m0:46:14[0m , [31m1,077 it/s[0m ]
    sys.exit(main())
             ^^^^^^
[2K  File "/Users/xiao/0_codes/my_rl/drake-gym/drake_gym/examples/train_franka_reach_PPO.py", line 257, in mainâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m12,228/3,000,000 [0m [ [33m0:00:22[0m < [36m0:46:14[0m , [31m1,077 it/s[0m ]
    model.learn(
[2K  File "/Users/xiao/miniforge3/envs/robotics/lib/python3.12/site-packages/stable_baselines3/ppo/ppo.py", line 311, in learnâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m12,228/3,000,000 [0m [ [33m0:00:22[0m < [36m0:46:14[0m , [31m1,077 it/s[0m ]
    return super().learn(
           ^^^^^^^^^^^^^^
[2K  File "/Users/xiao/miniforge3/envs/robotics/lib/python3.12/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 337, in learnâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m12,228/3,000,000 [0m [ [33m0:00:22[0m < [36m0:46:14[0m , [31m1,077 it/s[0m ]
    self.train()
[2K  File "/Users/xiao/miniforge3/envs/robotics/lib/python3.12/site-packages/stable_baselines3/ppo/ppo.py", line 207, in trainâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m12,228/3,000,000 [0m [ [33m0:00:22[0m < [36m0:46:14[0m , [31m1,077 it/s[0m ]
    for rollout_data in self.rollout_buffer.get(self.batch_size):
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2K  File "/Users/xiao/miniforge3/envs/robotics/lib/python3.12/site-packages/stable_baselines3/common/buffers.py", line 505, in getâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m12,228/3,000,000 [0m [ [33m0:00:22[0m < [36m0:46:14[0m , [31m1,077 it/s[0m ]
    yield self._get_samples(indices[start_idx : start_idx + batch_size])
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2K  File "/Users/xiao/miniforge3/envs/robotics/lib/python3.12/site-packages/stable_baselines3/common/buffers.py", line 522, in _get_samplesâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m12,228/3,000,000 [0m [ [33m0:00:22[0m < [36m0:46:14[0m , [31m1,077 it/s[0m ]
    return RolloutBufferSamples(*tuple(map(self.to_torch, data)))
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2K  File "/Users/xiao/miniforge3/envs/robotics/lib/python3.12/site-packages/stable_baselines3/common/buffers.py", line 139, in to_torchâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m12,228/3,000,000 [0m [ [33m0:00:22[0m < [36m0:46:14[0m , [31m1,077 it/s[0m ]
    return th.tensor(array, device=self.device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2KKeyboardInterrupt;249;38;114mâ•¸[0m[38;5;237mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m12,228/3,000,000 [0m [ [33m0:00:22[0m < [36m0:46:14[0m , [31m1,077 it/s[0m ]
[35m   0%[0m [38;2;249;38;114mâ•¸[0m[38;5;237mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m12,228/3,000,000 [0m [ [33m0:00:22[0m < [36m0:46:14[0m , [31m1,077 it/s[0m ]
